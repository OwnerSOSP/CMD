(echo "\n   ______________________________________\n  /                                      \ \n  ========================================\n  $(getprop ro.product.brand) ($(getprop ro.product.model)) tweaker\n  ========================================\n  hardware       : $(case $(getprop ro.hardware|tr [:upper:] [:lower:]) in mt*) echo mediatek;;apq*|msm*|qcom*|sd*|sm*) echo qualcomm;;exynos*|s5e*|universal*) echo samsung;;gs*|tensor*) echo google;;hi*|kirin*) echo hisilicon;;sc*|t*|ums*|unisoc*) echo unisoc;;*) echo unknown;;esac) ($(getprop ro.hardware))\n  software       : android ($(getprop ro.build.version.release))\n  ========================================\n  wait about 10 minutes until successful\n  ========================================\n  \                                      /\n   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯\n")|tr '[:lower:]' '[:upper:]'
exec>/dev/null 2>&1;rm /sdcard/!SUCCESSFUL.log;touch /sdcard/!INSTALLING.log

# please add important packages
important="
com.miHoYo.GenshinImpact
com.linuxauthority.screenrecorder
com.spotify.music
"#241001
ip="$(for a in $important
do printf "$a|"
done)systemui"

# unimportant packages
filter=google # google or ""
# use google if want to low prio google apps (except important)
# use "" if want to low prio all apps (except important)

# downscale for games
downscale=disable # 0.3 to 0.9 or disable
# smaller = smoother but also more dotted

# disable gms if dnd is active
use_smart_gms=0 # 0 = false or 1 = true
# don't use disable gms if don't want to lose contacts

# rendering
render=skiagl # skiagl or skiavk
# don't use skiavk if your rom is not compatible

# appops settings for important and unimportant
permission="FOREGROUND_SERVICE_SPECIAL_USE INSTANT_APP_START_FOREGROUND RUN_ANY_IN_BACKGROUND RUN_IN_BACKGROUND START_FOREGROUND"
# make permission="" if don't want to use appops

(for a in $(cmd device_config list|cut -f1 -d=);do cmd device_config delete "${a%/*}" "${a#*/}"&done;for b in $(dumpsys game|grep -o "$(cmd package list packages|cut -f2 -d:)");do cmd device_config put game_overlay "$b" mode=4,downscaleFactor="$downscale",useAngle=true,fps="$(dumpsys display|grep PEAK|cut -f7 -d:|cut -f4 -d\ |cut -f1 -d.)",loadingBoost=999999999&done;echo 'Success : Delete Device Config'>>/sdcard/!INSTALLING.log)&(for a in $(cmd package list packages -s|cut -f2 -d:);do rm -rf "/sdcard/Android/data/$a";rm -rf "/sdcard/Android/media/$a";rm -rf "/sdcard/Android/obb/$a";done;echo 'Success : Remove System Trash'>>/sdcard/!INSTALLING.log)&(for a in $(getprop|grep -F [log.tag|cut -f1 -d]|sed 's/\[/persist./g') $(getprop|grep -F [persist.log.tag|cut -f1 -d]|sed 's/\[persist.//g');do setprop "$a" S&done;eval "$(seq 999|sed 's/^/logcat -c\&#/g')";echo 'Success : Logcat Killer'>>/sdcard/!INSTALLING.log)&(unset LD_LIBRARY_PATH;unset LD_PRELOAD;for a in /*/lib*/*/lib*.so /*/*/lib*/*/lib*.so;do export LD_LIBRARY_PATH="$(echo $a|sed 's,/[^/]*$,,g')";export LD_PRELOAD="$(echo $a|sed 's|.*/||')";done;echo 'Success : Library Dynamic Preload'>>/sdcard/!INSTALLING.log)&(if [ "$use_smart_gms" = 1 ];then while true;do if [ $(cmd settings get global zen_mode) = 1 ];then cmd package disable-user com.google.android.gms;else cmd package enable com.google.android.gms;fi;sleep 10;done;fi)&(while true;do if [ $(cmd settings get global zen_mode) = 1 ];then cmd settings put global activity_manager_constants background_settle_time=0,content_provider_retain_time=0,fgservice_min_report_time=0,fgservice_min_shown_time=0,fgservice_screen_on_after_time=0,fgservice_screen_on_before_time=0,full_pss_lowered_interval=0,full_pss_min_interval=0,gc_min_interval=0,gc_timeout=0,max_cached_processes=0,memory_info_throttle_time=0,power_check_interval=0,power_check_max_cpu_1=0,power_check_max_cpu_2=0,power_check_max_cpu_3=0,power_check_max_cpu_4=0,process_start_async=0,service_bg_activity_start_timeout=0,service_bg_start_timeout=0,service_crash_max_retry=0,service_crash_restart_duration=0,service_max_inactivity=0,service_min_restart_time_between=0,service_reset_run_duration=0,service_restart_duration=0,service_restart_duration_factor=0,service_usage_interaction_time=0,top_to_fgs_grace_duration=0,usage_stats_interaction_interval=0;else cmd settings delete global activity_manager_constants;fi;sleep 10;done)&(for a in $(cmd settings list global|grep driver|cut -f1 -d=);do cmd settings delete global "$a";done;cmd settings put global angle_gl_driver_all_angle 1;cmd settings put global game_driver_all_apps 1;cmd settings put global updatable_driver_all_apps 1;echo 'Success : Driver Game & Angle'>>/sdcard/!INSTALLING.log)&(for a in $(cmd package list packages|cut -f2 -d:);do cmd activity service-restart-backoff disable "$a";cmd shortcut clear-shortcuts "$a";cmd package art clear-app-profiles "$a";cmd package log-visibility --disable "$a";cmd usagestats clear-last-used-timestamps "$a";done;echo 'Success : Tweak To All Apps'>>/sdcard/!INSTALLING.log)&(for a in $(cmd package list packages|grep -Ei "$ip"|cut -f2 -d:);do for b in $permission;do cmd appops set "$a" "$b" allow;done;for c in $(cmd package list packages -U "$a"|cut -f3 -d:);do cmd activity set-deterministic-uid-idle "$c" false;cmd netpolicy add restrict-background-whitelist "$c";cmd netpolicy remove restrict-background-blacklist "$c";cmd netpolicy add app-idle-whitelist "$c";done;cmd activity set-bg-restriction-level --user 0 "$a" unrestricted;cmd activity set-foreground-service-delegate --user 0 "$a" start;cmd activity set-inactive "$a" false;cmd activity set-standby-bucket "$a" 10;cmd app_hibernation set-state "$a" false;cmd deviceidle whitelist "+$a";cmd dropbox remove-low-priority "$a";cmd media.audio_policy set-uid-state "$a" active;cmd media.camera set-uid-state "$a" active;cmd package compile -r bg-dexopt -m everything -p PRIORITY_INTERACTIVE_FAST -f --primary-dex --secondary-dex --include-dependencies --full "$a";cmd sensorservice set-uid-state "$a" active;cmd tare set-vip 0 "$a" true;done;echo 'Success : High Prio To Important Apps'>>/sdcard/!INSTALLING.log)&(for a in $(cmd package list packages "$filter"|grep -Eiv "$ip|ia.mo"|cut -f2 -d:);do for b in $permission;do cmd appops set "$a" "$b" ignore;done;for c in $(cmd package list packages -U "$a"|cut -f3 -d:);do cmd netpolicy remove restrict-background-whitelist "$c";cmd netpolicy add restrict-background-blacklist "$c";cmd netpolicy remove app-idle-whitelist "$c";done;cmd activity set-bg-restriction-level --user 0 "$a" hibernation;cmd activity set-deterministic-uid-idle "$a" true;cmd activity set-foreground-service-delegate --user 0 "$a" stop;cmd activity set-inactive "$a" true;cmd activity set-standby-bucket "$a" 50;cmd app_hibernation set-state "$a" true;cmd deviceidle whitelist "-$a";cmd dropbox add-low-priority "$a";cmd media.audio_policy set-uid-state "$a" idle;cmd media.camera set-uid-state "$a" idle;cmd package compile -r bg-dexopt -m assume-verified -p PRIORITY_BACKGROUND -f --primary-dex --secondary-dex --include-dependencies --full "$a";cmd sensorservice set-uid-state "$a" idle;cmd tare set-vip 0 "$a" false;done;echo 'Success : Low Prio To Unimportant Apps'>>/sdcard/!INSTALLING.log)&(cmd activity clear-debug-app;cmd activity clear-exit-info;cmd activity clear-watch-heap all;cmd activity memory-factor set CRITICAL;cmd activity idle-maintenance;cmd autofill set log_level off;cmd blob_store clear-all-blobs;cmd blob_store clear-all-sessions;cmd blob_store idle-maintenance;cmd companiondevice clear-association-memory-cache;cmd device_config set_sync_disabled_for_tests persistent;cmd device_policy clear-freeze-period-record;cmd deviceidle enable deep;cmd deviceidle force-idle deep;cmd deviceidle step deep;cmd display ab-logging-disable;cmd display dmd-logging-disable;cmd display dwb-logging-disable;cmd display set-user-disabled-hdr-types 1 2 3 4;cmd dropbox set-rate-limit 999999999;cmd font clear;cmd lock_settings remove-cache;cmd looper_stats disable;cmd jobscheduler trigger-dock-state idle;cmd media.camera clear-stream-use-case-override;cmd otadexopt cleanup;cmd package art cleanup;cmd package trim-caches 999G;cmd power set-adaptive-power-saver-enabled false;cmd power set-fixed-performance-mode-enabled true;cmd power set-mode 0;cmd safety_center clear-data;cmd stats clear-puller-cache;cmd thermalservice override-status 0;cmd time_detector clear_network_time;cmd time_detector clear_system_clock_network_time;cmd time_zone_detector set_auto_detection_enabled true;cmd time_zone_detector set_auto_detection_enabled false;cmd voiceinteraction set-debug-hotword-logging false;cmd webviewupdate disable-multiprocess;cmd wifi set-connected-score 60;cmd wifi set-ipreach-disconnect disabled;cmd wifi set-network-selection-config disabled enabled -a 0;cmd wifi set-network-selection-config enabled disabled -a 0;cmd wifi set-one-shot-screen-on-delay-ms 0;cmd wifi set-scan-always-available disabled;cmd wifi set-verbose-logging disabled -l 0;logcat -G $(getprop dalvik.vm.heapgrowthlimit);sm fstrim;sm idle-maint abort;echo 'Success : Some Tweak'>>/sdcard/!INSTALLING.log)&(setprop debug.hwui.renderer "$render";setprop debug.renderengine.backend "$render"threaded;setprop debug.sf.disable_backpressure 1;setprop debug.sf.early_app_phase_offset_ns 500000;setprop debug.sf.early_gl_app_phase_offset_ns 15000000;setprop debug.sf.early_gl_phase_offset_ns 3000000;setprop debug.sf.early_phase_offset_ns 500000;setprop debug.sf.enable_hwc_vds 0;setprop debug.sf.high_fps_early_gl_phase_offset_ns 650000;setprop debug.sf.high_fps_early_phase_offset_ns 6100000;setprop debug.sf.high_fps_late_app_phase_offset_ns 100000;setprop debug.sf.hw 1;setprop debug.sf.latch_unsignaled 1;setprop debug.sf.phase_offset_threshold_for_next_vsync_ns 6100000;setprop debug.sf.showbackground 0;setprop debug.sf.showcpu 0;setprop debug.sf.showfps 0;setprop debug.sf.showupdates 0;setprop iorapd.perfetto.enable false;setprop iorapd.readahead.enable false;setprop persist.device_config.runtime_native_boot.iorap_readahead_enable false;setprop persist.sys.dalvik.hyperthreading true;setprop persist.sys.dalvik.multithread true;setprop persist.sys.purgeable_assets 1;setprop ro.hwui.drop_shadow_cache_size 8;setprop ro.hwui.gradient_cache_size 2;setprop ro.hwui.layer_cache_size 64;setprop ro.hwui.path_cache_size 64;setprop ro.hwui.r_buffer_cache_size 16;setprop ro.hwui.text_large_cache_height 4096;setprop ro.hwui.text_large_cache_width 4096;setprop ro.hwui.text_small_cache_height 2048;setprop ro.hwui.text_small_cache_width 2048;setprop ro.hwui.texture_cache_flushrate 0.2;setprop ro.hwui.texture_cache_size 128;setprop ro.iorapd.enable false;echo 'Success : Prop From Rev4'>>/sdcard/!INSTALLING.log)&(while true;do sleep 10;if [ "$(du -b /sdcard/!INSTALLING.log|cut -f1 -d\	)" = "300" ];then mv /sdcard/!INSTALLING.log /sdcard/!SUCCESSFUL.log;cmd notification post -S bigtext -t '' tag 'Successfull';su -lp 2000 -c "cmd notification post -S bigtext -t '' tag 'Successfull'";eval "$(cmd package list packages|grep -Ev "wallpaper|theme|systemui|shell|ia.mo"|sed "s/package:/cmd activity force-stop /g"|sed "s/$/\&/g")";break;fi;done)&
